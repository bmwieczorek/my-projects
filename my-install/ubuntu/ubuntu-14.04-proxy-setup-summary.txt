bartek@ubuntu-vm:~$ df -h
Filesystem      Size  Used Avail Use% Mounted on
udev            2,0G  4,0K  2,0G   1% /dev
tmpfs           396M  960K  395M   1% /run
/dev/sda1        16G  4,3G   11G  29% /
none            4,0K     0  4,0K   0% /sys/fs/cgroup
none            5,0M     0  5,0M   0% /run/lock
none            2,0G   76K  2,0G   1% /run/shm
none            100M   36K  100M   1% /run/user
.m2             299G  252G   47G  85% /media/sf_.m2
vbox-shared     299G  252G   47G  85% /media/sf_vbox-shared
bartek@ubuntu-vm:~$ cat /etc/resolv.conf 
nameserver 10.136.85.27
nameserver 10.136.85.32
nameserver 192.168.11.1
search mycompany.com
bartek@ubuntu-vm:~$ cat /etc/environment
PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
http_proxy="http://localhost:3128/"
no_proxy="localhost,127.0.0.1,.mycompany.com"
HTTP_PROXY="http://localhost:3128/"
HTTPS_PROXY="http://localhost:3128/"
FTP_PROXY="http://localhost:3128/"
NO_PROXY="localhost,127.0.0.1,.mycompany.com"
bartek@ubuntu-vm:~$ cat /etc/apt/apt.conf.d/95proxies 
Acquire::http::proxy "http://localhost:3128/";
Acquire::ftp::proxy "ftp://localhost:3128/";
Acquire::https::proxy "https://localhost:3128/";
bartek@ubuntu-vm:~$ cat .mozilla/firefox/rvtrpduo.default/prefs.js | grep proxy
user_pref("network.proxy.backup.ftp", "www-ad-proxy.mycompany.com");
user_pref("network.proxy.backup.ftp_port", 80);
user_pref("network.proxy.backup.socks", "www-ad-proxy.mycompany.com");
user_pref("network.proxy.backup.socks_port", 80);
user_pref("network.proxy.backup.ssl", "www-ad-proxy.mycompany.com");
user_pref("network.proxy.backup.ssl_port", 80);
user_pref("network.proxy.ftp", "localhost");
user_pref("network.proxy.ftp_port", 3128);
user_pref("network.proxy.http", "localhost");
user_pref("network.proxy.http_port", 3128);
user_pref("network.proxy.no_proxies_on", "localhost, 127.0.0.1, .mycompany.com");
user_pref("network.proxy.share_proxy_settings", true);
user_pref("network.proxy.socks", "localhost");
user_pref("network.proxy.socks_port", 3128);
user_pref("network.proxy.ssl", "localhost");
user_pref("network.proxy.ssl_port", 3128);
user_pref("network.proxy.type", 1);
user_pref("signon.autologin.proxy", true);
bartek@ubuntu-vm:~$ cat /etc/resolv.conf 
nameserver 10.136.85.27
nameserver 10.136.85.32
nameserver 192.168.11.1
search mycompany.com
bartek@ubuntu-vm:~$ cat /etc/environment
PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
http_proxy="http://localhost:3128/"
no_proxy="localhost,127.0.0.1,.mycompany.com"
HTTP_PROXY="http://localhost:3128/"
HTTPS_PROXY="http://localhost:3128/"
FTP_PROXY="http://localhost:3128/"
NO_PROXY="localhost,127.0.0.1,.mycompany.com"
bartek@ubuntu-vm:~$ cat /etc/apt/apt.conf.d/95proxies 
Acquire::http::proxy "http://localhost:3128/";
Acquire::ftp::proxy "ftp://localhost:3128/";
Acquire::https::proxy "https://localhost:3128/";
bartek@ubuntu-vm:~$ cat .mozilla/firefox/rvtrpduo.default/prefs.js | grep proxy
user_pref("network.proxy.backup.ftp", "www-ad-proxy.mycompany.com");
user_pref("network.proxy.backup.ftp_port", 80);
user_pref("network.proxy.backup.socks", "www-ad-proxy.mycompany.com");
user_pref("network.proxy.backup.socks_port", 80);
user_pref("network.proxy.backup.ssl", "www-ad-proxy.mycompany.com");
user_pref("network.proxy.backup.ssl_port", 80);
user_pref("network.proxy.ftp", "localhost");
user_pref("network.proxy.ftp_port", 3128);
user_pref("network.proxy.http", "localhost");
user_pref("network.proxy.http_port", 3128);
user_pref("network.proxy.no_proxies_on", "localhost, 127.0.0.1, .mycompany.com");
user_pref("network.proxy.share_proxy_settings", true);
user_pref("network.proxy.socks", "localhost");
user_pref("network.proxy.socks_port", 3128);
user_pref("network.proxy.ssl", "localhost");
user_pref("network.proxy.ssl_port", 3128);
user_pref("network.proxy.type", 1);
user_pref("signon.autologin.proxy", true);
bartek@ubuntu-vm:~$ gsettings list-recursively | grep proxy
org.gnome.system.proxy.https host ''
org.gnome.system.proxy.https port 0
org.gnome.evolution.shell.network-config proxy-type 0
org.gnome.evolution.shell.network-config use-http-proxy false
org.gnome.settings-daemon.plugins.screensaver-proxy active true
org.gnome.settings-daemon.plugins.screensaver-proxy priority 0
org.gnome.system.proxy.socks host ''
org.gnome.system.proxy.socks port 0
org.gnome.system.proxy use-same-proxy false
org.gnome.system.proxy mode 'manual'
org.gnome.system.proxy autoconfig-url ''
org.gnome.system.proxy ignore-hosts ['localhost', '127.0.0.0/8', '::1']
org.gnome.system.proxy.ftp host ''
org.gnome.system.proxy.ftp port 0
org.gnome.system.proxy.socks host ''
org.gnome.system.proxy.socks port 0
org.gnome.system.proxy.http host 'localhost'
org.gnome.system.proxy.http port 3128
org.gnome.system.proxy.http use-authentication false
org.gnome.system.proxy.http authentication-password ''
org.gnome.system.proxy.http authentication-user ''
org.gnome.system.proxy.http enabled false
org.gnome.system.proxy.https host ''
org.gnome.system.proxy.https port 0
org.gnome.system.proxy.ftp host ''
org.gnome.system.proxy.ftp port 0
org.gnome.system.proxy.http host 'localhost'
org.gnome.system.proxy.http port 3128
org.gnome.system.proxy.http use-authentication false
org.gnome.system.proxy.http authentication-password ''
org.gnome.system.proxy.http authentication-user ''
org.gnome.system.proxy.http enabled false
org.gnome.settings-daemon.plugins.screensaver-proxy active true
org.gnome.settings-daemon.plugins.screensaver-proxy priority 0
bartek@ubuntu-vm:~$ sudo cat /etc/cntlm.conf
[sudo] password for bartek: 
#
# Cntlm Authentication Proxy Configuration
#
# NOTE: all values are parsed literally, do NOT escape spaces,
# do not quote. Use 0600 perms if you use plaintext password.
#

Username	myusername
Domain		mydomain
#Password	
# NOTE: Use plaintext password only at your own risk
# Use hashes instead. You can use a "cntlm -M" and "cntlm -H"
# command sequence to get the right config for your environment.
# See cntlm man page
# Example secure config shown below.

#T...33
#bartek@ubuntu-vm:/etc$ sudo cntlm -I -M http://test.com
#Password: 
#Config profile  1/4... Credentials rejected
#Config profile  2/4... OK (HTTP code: 302)
#----------------------------[ Profile  1 ]------
#Auth            NTLM
#PassNT          0DA035657084091F3A473981937A043F
#PassLM          67CE777FF867BFD2B1858F7C8CB2A895
Auth            NTLM
PassNT          0DA035657084091F3A473981937A043F
PassLM          67CE777FF867BFD2B1858F7C8CB2A895

### Only for user 'testuser', domain 'corp-uk'
# PassNTLMv2      D5826E9C665C37C80B53397D5C07BBCB

# Specify the netbios hostname cntlm will send to the parent
# proxies. Normally the value is auto-guessed.
#
# Workstation	netbios_hostname

# List of parent proxies to use. More proxies can be defined
# one per line in format <proxy_ip>:<proxy_port>
#

#www-ad-proxy.mycompany.com
Proxy		10.136.87.17:80

#tulsa-proxy.mycompany.com
Proxy		151.193.220.27:80

# List addresses you do not want to pass to parent proxies
# * and ? wildcards can be used
#
NoProxy		localhost, 127.0.0.*, 10.*, 192.168.*, *.mycompany.com

# Specify the port cntlm will listen on
# You can bind cntlm to specific interface by specifying
# the appropriate IP address also in format <local_ip>:<local_port>
# Cntlm listens on 127.0.0.1:3128 by default
#
Listen		3128

# If you wish to use the SOCKS5 proxy feature as well, uncomment
# the following option. It can be used several times
# to have SOCKS5 on more than one port or on different network
# interfaces (specify explicit source address for that).
#
# WARNING: The service accepts all requests, unless you use
# SOCKS5User and make authentication mandatory. SOCKS5User
# can be used repeatedly for a whole bunch of individual accounts.
#
#SOCKS5Proxy	8010
#SOCKS5User	dave:password

# Use -M first to detect the best NTLM settings for your proxy.
# Default is to use the only secure hash, NTLMv2, but it is not
# as available as the older stuff.
#
# This example is the most universal setup known to man, but it
# uses the weakest hash ever. I won't have it's usage on my
# conscience. :) Really, try -M first.
#
#Auth		LM
#Flags		0x06820000

# Enable to allow access from other computers
#
#Gateway	yes

# Useful in Gateway mode to allow/restrict certain IPs
# Specifiy individual IPs or subnets one rule per line.
#
#Allow		127.0.0.1
#Deny		0/0

# GFI WebMonitor-handling plugin parameters, disabled by default
#
#ISAScannerSize     1024
#ISAScannerAgent    Wget/
#ISAScannerAgent    APT-HTTP/
#ISAScannerAgent    Yum/

# Headers which should be replaced if present in the request
#
#Header		User-Agent: Mozilla/4.0 (compatible; MSIE 5.5; Windows 98)

# Tunnels mapping local port to a machine behind the proxy.
# The format is <local_port>:<remote_host>:<remote_port>
# 
#Tunnel		11443:remote.com:443


Ubuntu 16.04
bartek@ubuntu-vm:~$ sudo vim /etc/environment 
[sudo] hasło użytkownika bartek: 
bartek@ubuntu-vm:~$ sudo cp /etc/cntlm.conf /etc/cntlm.conf.orig
bartek@ubuntu-vm:~$ sudo cp /etc/environment /etc/environment.orig
bartek@ubuntu-vm:~$ sudo vim /etc/environment.orig 
bartek@ubuntu-vm:~$ sudo vim /etc/apt/apt.conf.d/95proxies 
bartek@ubuntu-vm:~$ sudo cp /etc/resolv.conf /etc/resolv.conf.orig
bartek@ubuntu-vm:~$ sudo vim /etc/resolv.conf
bartek@ubuntu-vm:~$ sudo cp /etc/resolv.conf /etc/resolv.conf.proxy
bartek@ubuntu-vm:~$ sudo cp /etc/apt/apt.conf.d/95proxies .
bartek@ubuntu-vm:~$ vim .mozilla/firefox/rvtrpduo.default/prefs.js
bartek@ubuntu-vm:~$ vim .mozilla/firefox/
Crash Reports/    profiles.ini      q6dhtkuv.default/ 
bartek@ubuntu-vm:~$ cp .mozilla/firefox/q6dhtkuv.default/prefs.js .
bartek@ubuntu-vm:~$ vim .mozilla/firefox/q6dhtkuv.default/prefs.js 
bartek@ubuntu-vm:~$ cp .mozilla/firefox/q6dhtkuv.default/prefs.js prefs.js.proxy
bartek@ubuntu-vm:~$ gsettings list-recursively | grep proxy
org.gnome.system.proxy.https host ''
org.gnome.system.proxy.https port 0
org.gnome.evolution.shell.network-config proxy-type 0
org.gnome.evolution.shell.network-config use-http-proxy false
org.gnome.settings-daemon.plugins.screensaver-proxy active true
org.gnome.settings-daemon.plugins.screensaver-proxy priority 0
org.gnome.system.proxy.socks host ''
org.gnome.system.proxy.socks port 0
org.gnome.system.proxy use-same-proxy true
org.gnome.system.proxy mode 'none'
org.gnome.system.proxy autoconfig-url ''
org.gnome.system.proxy ignore-hosts ['localhost', '127.0.0.0/8', '::1']
org.gnome.system.proxy.ftp host ''
org.gnome.system.proxy.ftp port 0
org.gnome.system.proxy.socks host ''
org.gnome.system.proxy.socks port 0
org.gnome.system.proxy.http host ''
org.gnome.system.proxy.http port 8080
org.gnome.system.proxy.http use-authentication false
org.gnome.system.proxy.http authentication-password ''
org.gnome.system.proxy.http authentication-user ''
org.gnome.system.proxy.http enabled false
org.gnome.system.proxy.https host ''
org.gnome.system.proxy.https port 0
org.gnome.system.proxy.ftp host ''
org.gnome.system.proxy.ftp port 0
org.gnome.system.proxy.http host ''
org.gnome.system.proxy.http port 8080
org.gnome.system.proxy.http use-authentication false
org.gnome.system.proxy.http authentication-password ''
org.gnome.system.proxy.http authentication-user ''
org.gnome.system.proxy.http enabled false
org.gnome.settings-daemon.plugins.screensaver-proxy active true
org.gnome.settings-daemon.plugins.screensaver-proxy priority 0
bartek@ubuntu-vm:~$ gsettings set org.gnome.system.proxy mode 'manual'
bartek@ubuntu-vm:~$ gsettings set org.gnome.system.proxy.http port 3128
bartek@ubuntu-vm:~$ gsettings set org.gnome.system.proxy.http host 'localhost'
bartek@ubuntu-vm:~$ gsettings set org.gnome.system.proxy use-same-proxy false
